<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytorch_tools package &mdash; pytorch_tools  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pytorch_tools" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pytorch_tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pytorch_tools</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pytorch_tools package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.data_augmentation_utils">pytorch_tools.data_augmentation_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.Compose"><code class="docutils literal notranslate"><span class="pre">Compose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.LimbDrop"><code class="docutils literal notranslate"><span class="pre">LimbDrop</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.NodeDrop"><code class="docutils literal notranslate"><span class="pre">NodeDrop</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.NodeFeatureMask"><code class="docutils literal notranslate"><span class="pre">NodeFeatureMask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.NodeFeatureNoise"><code class="docutils literal notranslate"><span class="pre">NodeFeatureNoise</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.compose_augmentation"><code class="docutils literal notranslate"><span class="pre">compose_augmentation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.drop_limbs"><code class="docutils literal notranslate"><span class="pre">drop_limbs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.drop_nodes"><code class="docutils literal notranslate"><span class="pre">drop_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.mask_addition_if_totally_eliminated"><code class="docutils literal notranslate"><span class="pre">mask_addition_if_totally_eliminated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.pool_idx_stacked"><code class="docutils literal notranslate"><span class="pre">pool_idx_stacked()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.data_augmentation_utils.set_ptr"><code class="docutils literal notranslate"><span class="pre">set_ptr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.dgl_utils">pytorch_tools.dgl_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.dgl_utils.from_networkx"><code class="docutils literal notranslate"><span class="pre">from_networkx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.dgl_utils.g_from_data"><code class="docutils literal notranslate"><span class="pre">g_from_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.evaluation_utils">pytorch_tools.evaluation_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.accuracy"><code class="docutils literal notranslate"><span class="pre">accuracy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.f1"><code class="docutils literal notranslate"><span class="pre">f1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.metric_dict"><code class="docutils literal notranslate"><span class="pre">metric_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.metric_pre"><code class="docutils literal notranslate"><span class="pre">metric_pre()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.precision"><code class="docutils literal notranslate"><span class="pre">precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.recall"><code class="docutils literal notranslate"><span class="pre">recall()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.evaluation_utils.true_false_pos_neg"><code class="docutils literal notranslate"><span class="pre">true_false_pos_neg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.geometric_dataset_utils">pytorch_tools.geometric_dataset_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.DataHierarchical"><code class="docutils literal notranslate"><span class="pre">DataHierarchical</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.closest_neighbors_in_embedding_df"><code class="docutils literal notranslate"><span class="pre">closest_neighbors_in_embedding_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.drop_limbs"><code class="docutils literal notranslate"><span class="pre">drop_limbs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.drop_nodes"><code class="docutils literal notranslate"><span class="pre">drop_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.example_data_obj"><code class="docutils literal notranslate"><span class="pre">example_data_obj()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.int_label_map"><code class="docutils literal notranslate"><span class="pre">int_label_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.load_data"><code class="docutils literal notranslate"><span class="pre">load_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.load_data_hierarchical"><code class="docutils literal notranslate"><span class="pre">load_data_hierarchical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.normalization_df"><code class="docutils literal notranslate"><span class="pre">normalization_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.normalization_df_hierarchical"><code class="docutils literal notranslate"><span class="pre">normalization_df_hierarchical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.normalize_and_filter_x_columns"><code class="docutils literal notranslate"><span class="pre">normalize_and_filter_x_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.pool_array_names"><code class="docutils literal notranslate"><span class="pre">pool_array_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.pool_idx_stacked"><code class="docutils literal notranslate"><span class="pre">pool_idx_stacked()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.pytorch_data_hierarchical_from_single_data"><code class="docutils literal notranslate"><span class="pre">pytorch_data_hierarchical_from_single_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.set_ptr"><code class="docutils literal notranslate"><span class="pre">set_ptr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.x_column_feature_name"><code class="docutils literal notranslate"><span class="pre">x_column_feature_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_dataset_utils.x_columns"><code class="docutils literal notranslate"><span class="pre">x_columns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.geometric_models">pytorch_tools.geometric_models module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.BatchedDiffPool"><code class="docutils literal notranslate"><span class="pre">BatchedDiffPool</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.BatchedGraphSAGE"><code class="docutils literal notranslate"><span class="pre">BatchedGraphSAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell"><code class="docutils literal notranslate"><span class="pre">ChildSumTreeLSTMCell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.Classifier"><code class="docutils literal notranslate"><span class="pre">Classifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.ClassifierBase"><code class="docutils literal notranslate"><span class="pre">ClassifierBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.ClassifierFlat"><code class="docutils literal notranslate"><span class="pre">ClassifierFlat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.DiffPoolGCN"><code class="docutils literal notranslate"><span class="pre">DiffPoolGCN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.DiffPoolSAGE"><code class="docutils literal notranslate"><span class="pre">DiffPoolSAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.DiffPoolSimpleGNN"><code class="docutils literal notranslate"><span class="pre">DiffPoolSimpleGNN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GAT"><code class="docutils literal notranslate"><span class="pre">GAT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GAT_old"><code class="docutils literal notranslate"><span class="pre">GAT_old</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GCN"><code class="docutils literal notranslate"><span class="pre">GCN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GCNFlat"><code class="docutils literal notranslate"><span class="pre">GCNFlat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GCNHierarchical"><code class="docutils literal notranslate"><span class="pre">GCNHierarchical</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GCNHierarchicalOld"><code class="docutils literal notranslate"><span class="pre">GCNHierarchicalOld</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.GraphSAGE"><code class="docutils literal notranslate"><span class="pre">GraphSAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.SAGEConvNet"><code class="docutils literal notranslate"><span class="pre">SAGEConvNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.TreeLSTM"><code class="docutils literal notranslate"><span class="pre">TreeLSTM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models.TreeLSTMCell"><code class="docutils literal notranslate"><span class="pre">TreeLSTMCell</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.geometric_models_overload">pytorch_tools.geometric_models_overload module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_models_overload.GCNConv"><code class="docutils literal notranslate"><span class="pre">GCNConv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.geometric_tensor_utils">pytorch_tools.geometric_tensor_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.global_mean_pool"><code class="docutils literal notranslate"><span class="pre">global_mean_pool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.global_mean_weighted_pool"><code class="docutils literal notranslate"><span class="pre">global_mean_weighted_pool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.n_in_pool_from_pool_tensor"><code class="docutils literal notranslate"><span class="pre">n_in_pool_from_pool_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.normalize_in_pool_from_pool_tensor"><code class="docutils literal notranslate"><span class="pre">normalize_in_pool_from_pool_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.pool_idx_from_pool_tensor"><code class="docutils literal notranslate"><span class="pre">pool_idx_from_pool_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_tensor_utils.ptr_from_pool_tensor"><code class="docutils literal notranslate"><span class="pre">ptr_from_pool_tensor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.geometric_utils">pytorch_tools.geometric_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.geometric_utils.from_networkx"><code class="docutils literal notranslate"><span class="pre">from_networkx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.hierarchical_utils">pytorch_tools.hierarchical_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier"><code class="docutils literal notranslate"><span class="pre">GCNHierarchicalClassifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.hierarchical_utils.forward_pass"><code class="docutils literal notranslate"><span class="pre">forward_pass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.hierarchical_utils.hierarchical_loss"><code class="docutils literal notranslate"><span class="pre">hierarchical_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.loss_utils">pytorch_tools.loss_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.model_utils">pytorch_tools.model_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.model_utils.load_checkpoint_to_model"><code class="docutils literal notranslate"><span class="pre">load_checkpoint_to_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.model_utils.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.parameters_utils">pytorch_tools.parameters_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.add_noise_to_parameters"><code class="docutils literal notranslate"><span class="pre">add_noise_to_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.check_gradient_on_parameters_finite"><code class="docutils literal notranslate"><span class="pre">check_gradient_on_parameters_finite()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.copy_model_parameters_to_model"><code class="docutils literal notranslate"><span class="pre">copy_model_parameters_to_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.isnan_in_parameters"><code class="docutils literal notranslate"><span class="pre">isnan_in_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.layer_bias"><code class="docutils literal notranslate"><span class="pre">layer_bias()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.layer_parameters"><code class="docutils literal notranslate"><span class="pre">layer_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.load_state_dict"><code class="docutils literal notranslate"><span class="pre">load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.parameters"><code class="docutils literal notranslate"><span class="pre">parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.print_parameters"><code class="docutils literal notranslate"><span class="pre">print_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.set_geometric_parameters"><code class="docutils literal notranslate"><span class="pre">set_geometric_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.parameters_utils.state_dict"><code class="docutils literal notranslate"><span class="pre">state_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.preprocessing_utils">pytorch_tools.preprocessing_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.preprocessing_utils.train_val_test_split"><code class="docutils literal notranslate"><span class="pre">train_val_test_split()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.tensor_utils">pytorch_tools.tensor_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.add_noise"><code class="docutils literal notranslate"><span class="pre">add_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.cat"><code class="docutils literal notranslate"><span class="pre">cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.cumsum"><code class="docutils literal notranslate"><span class="pre">cumsum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.generator_from_seed"><code class="docutils literal notranslate"><span class="pre">generator_from_seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.intersect1d"><code class="docutils literal notranslate"><span class="pre">intersect1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.isnan"><code class="docutils literal notranslate"><span class="pre">isnan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.isnan_any"><code class="docutils literal notranslate"><span class="pre">isnan_any()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.map_tensor_with_tensor"><code class="docutils literal notranslate"><span class="pre">map_tensor_with_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.numpy_array"><code class="docutils literal notranslate"><span class="pre">numpy_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.random_gaussian"><code class="docutils literal notranslate"><span class="pre">random_gaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.random_mask"><code class="docutils literal notranslate"><span class="pre">random_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.random_sample_between_interval"><code class="docutils literal notranslate"><span class="pre">random_sample_between_interval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensor_utils.vstack"><code class="docutils literal notranslate"><span class="pre">vstack()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.tensorboard_utils">pytorch_tools.tensorboard_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.tensorboard_utils.df_tensorboard"><code class="docutils literal notranslate"><span class="pre">df_tensorboard()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.torch_display_utils">pytorch_tools.torch_display_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.torch_display_utils.set_printoptions"><code class="docutils literal notranslate"><span class="pre">set_printoptions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.train_test_geometric_utils">pytorch_tools.train_test_geometric_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.train_test_geometric_utils.forward_pass"><code class="docutils literal notranslate"><span class="pre">forward_pass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_tools.train_test_geometric_utils.forward_pass_embed_df"><code class="docutils literal notranslate"><span class="pre">forward_pass_embed_df()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.training_layer_utils">pytorch_tools.training_layer_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools.xai_geometric_utils">pytorch_tools.xai_geometric_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_tools">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pytorch_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pytorch_tools</a></li>
      <li class="breadcrumb-item active">pytorch_tools package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pytorch_tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pytorch-tools-package">
<h1>pytorch_tools package<a class="headerlink" href="#pytorch-tools-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pytorch_tools.data_augmentation_utils">
<span id="pytorch-tools-data-augmentation-utils-module"></span><h2>pytorch_tools.data_augmentation_utils module<a class="headerlink" href="#module-pytorch_tools.data_augmentation_utils" title="Permalink to this heading"></a></h2>
<p>Deepmind paper that talks about training with high confidence samples:</p>
<p><a class="reference external" href="https://www.nature.com/articles/s41586-021-03819-2.pdf">https://www.nature.com/articles/s41586-021-03819-2.pdf</a>
- noisy student self-distillation</p>
<p><a class="reference external" href="https://github.com/rish-16/grafog">https://github.com/rish-16/grafog</a>
- general procedure
1) Write a class that inherits from module and overloads the forward function</p>
<ol class="arabic simple" start="2">
<li><p>create composition of node and edge augmentations</p></li>
<li><p>At every epoch fun the data through the augmentation</p></li>
</ol>
<p>Ex:</p>
<dl class="simple">
<dt>node_aug = T.Compose([</dt><dd><p>T.NodeDrop(p=0.45),
T.NodeMixUp(lamb=0.5, classes=7),
…</p>
</dd>
</dl>
<p>])</p>
<dl class="simple">
<dt>edge_aug = T.Compose([</dt><dd><p>T.EdgeDrop(0=0.15),
T.EdgeFeatureMasking()</p>
</dd>
</dl>
<p>])</p>
<p>data = CoraFull()
model = …</p>
<dl>
<dt>for epoch in range(10): # begin training loop</dt><dd><p>new_data = node_aug(data) # apply the node augmentation(s)
new_data = edge_aug(new_data) # apply the edge augmentation(s)</p>
<p>x, y = new_data.x, new_data.y
…</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.Compose">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">Compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transforms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#Compose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.Compose" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.Compose.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transforms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#Compose.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.Compose.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.Compose.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#Compose.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.Compose.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.Compose.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.Compose.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.LimbDrop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">LimbDrop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#LimbDrop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.LimbDrop" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.LimbDrop.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#LimbDrop.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.LimbDrop.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.LimbDrop.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#LimbDrop.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.LimbDrop.forward" title="Permalink to this definition"></a></dt>
<dd><p>Ex:
d = dau.example_data_obj()
dau.NodeDrop(p = 0.5)(d,verbose =True)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.LimbDrop.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.LimbDrop.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeDrop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">NodeDrop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeDrop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeDrop" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeDrop.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeDrop.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeDrop.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeDrop.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeDrop.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeDrop.forward" title="Permalink to this definition"></a></dt>
<dd><p>Ex:
d = dau.example_data_obj()
dau.NodeDrop(p = 0.5)(d,verbose =True)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeDrop.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeDrop.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureMask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">NodeFeatureMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureMask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureMask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureMask.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureMask.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureMask.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureMask.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureMask.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureMask.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureMask.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureMask.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">NodeFeatureNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureNoise" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureNoise.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureNoise.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureNoise.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureNoise.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#NodeFeatureNoise.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureNoise.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.NodeFeatureNoise.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.NodeFeatureNoise.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.compose_augmentation">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">compose_augmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmentations</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#compose_augmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.compose_augmentation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.drop_limbs">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">drop_limbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limb_map_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pool1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#drop_limbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.drop_limbs" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To drop limbs randomly from a dataset</p>
<p>Pseudocode:
1) Get a mask for the limbs
2) Turn the mask of the limbs into a mask for the nodes
3) Use drop_nodes function</p>
<p>Ex:
new_d = dau.drop_limbs(</p>
<blockquote>
<div><p>data = dau.example_data_obj(),
verbose = True,
p = 0.3</p>
</div></blockquote>
<p>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.drop_nodes">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">drop_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attributes_to_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#drop_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.drop_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: to delete certain nodes from a dataset
based on a mask</p>
<p>Pseudocode:
1) Generate the mask if not defined
2) Get the node_idx of the mask
3) Generate vector of the new node ids</p>
<p>4) Find the new edges by dropping the edges with the nodes
and then finding the new edge</p>
<p>Ex:
from torch_geometric.data import Data
import numpy as np
from pytorch_tools import geometric_dataset_utils as gdu</p>
<p>d = dau.example_data_obj()
new_d = dau.drop_nodes(</p>
<blockquote>
<div><p>d,
p=0.5,
verbose = True,
#node_attributes_to_adjust=pool_attributes_affected_by_nodes</p>
</div></blockquote>
<p>)</p>
<p>Ex: With a prescribed mask</p>
<p>d = dau.example_data_obj()
new_d = dau.drop_nodes(</p>
<blockquote>
<div><p>d,
mask = torch.tensor([0,0,1,0,0,0],dtype=torch.bool),
p=0.5,
verbose = True,
#node_attributes_to_adjust=pool_attributes_affected_by_nodes</p>
</div></blockquote>
<p>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.mask_addition_if_totally_eliminated">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">mask_addition_if_totally_eliminated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#mask_addition_if_totally_eliminated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.mask_addition_if_totally_eliminated" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To come up with a mask indicating
what positions need to be fixed in order for the
mask not to totally eliminated a batch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.pool_idx_stacked">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">pool_idx_stacked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pool1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_n_limbs_for_neuron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_adjustment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#pool_idx_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.pool_idx_stacked" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To generate a vector that represents the
mapping of nodes to unique limbs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.data_augmentation_utils.set_ptr">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.data_augmentation_utils.</span></span><span class="sig-name descname"><span class="pre">set_ptr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/data_augmentation_utils.html#set_ptr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.data_augmentation_utils.set_ptr" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: to compute the new ptr
if a batch is readjusted</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.dgl_utils">
<span id="pytorch-tools-dgl-utils-module"></span><h2>pytorch_tools.dgl_utils module<a class="headerlink" href="#module-pytorch_tools.dgl_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.dgl_utils.from_networkx">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.dgl_utils.</span></span><span class="sig-name descname"><span class="pre">from_networkx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_id_attr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/dgl_utils.html#from_networkx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.dgl_utils.from_networkx" title="Permalink to this definition"></a></dt>
<dd><p>Documenation: <a class="reference external" href="https://docs.dgl.ai/en/0.6.x/generated/dgl.from_networkx.html">https://docs.dgl.ai/en/0.6.x/generated/dgl.from_networkx.html</a></p>
<p>Ex:</p>
<p>segment_id = 31495760671
split_index = 0
G = hdju.graph_obj_from_proof_stage(segment_id=segment_id,split_index = split_index)</p>
<p>import dgl
g = dgl.from_networkx(</p>
<blockquote>
<div><p>G,
node_attrs=[‘n_synapses’, ‘n_synapses_post’,”n_synapses_pre”],
#device =</p>
</div></blockquote>
<p>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.dgl_utils.g_from_data">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.dgl_utils.</span></span><span class="sig-name descname"><span class="pre">g_from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/dgl_utils.html#g_from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.dgl_utils.g_from_data" title="Permalink to this definition"></a></dt>
<dd><p>To create a dgl graph with the correct number of nodes
and edges (assume DiGraph)</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.evaluation_utils">
<span id="pytorch-tools-evaluation-utils-module"></span><h2>pytorch_tools.evaluation_utils module<a class="headerlink" href="#module-pytorch_tools.evaluation_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.accuracy">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.accuracy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.f1">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">f1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#f1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.f1" title="Permalink to this definition"></a></dt>
<dd><p>Calculate F1 score. Can work with gpu tensors</p>
<p>The original implmentation is written by Michal Haltuf on Kaggle.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>torch.Tensor</em> – <cite>ndim</cite> == 1. 0 &lt;= val &lt;= 1</p></li>
<li><p><em>Reference</em></p></li>
<li><p><em>———</em></p></li>
<li><p><strong>- https</strong> (<em>//www.kaggle.com/rejpalcz/best-loss-function-for-f1-score-metric</em>)</p></li>
<li><p><strong>- https</strong> (<em>//scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html#sklearn.metrics.f1_score</em>)</p></li>
<li><p><strong>- https</strong> (<em>//discuss.pytorch.org/t/calculating-precision-recall-and-f1-score-in-case-of-multi-label-classification/28265/6</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.metric_dict">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">metric_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#metric_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.metric_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.metric_pre">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">metric_pre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#metric_pre"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.metric_pre" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.precision">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.recall">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.recall" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.evaluation_utils.true_false_pos_neg">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.evaluation_utils.</span></span><span class="sig-name descname"><span class="pre">true_false_pos_neg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/evaluation_utils.html#true_false_pos_neg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.evaluation_utils.true_false_pos_neg" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To calculate the tp,tn,fp,fn for
binary classification</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.geometric_dataset_utils">
<span id="pytorch-tools-geometric-dataset-utils-module"></span><h2>pytorch_tools.geometric_dataset_utils module<a class="headerlink" href="#module-pytorch_tools.geometric_dataset_utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.DataHierarchical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">DataHierarchical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#DataHierarchical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.DataHierarchical" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.DataHierarchical.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#DataHierarchical.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.DataHierarchical.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.closest_neighbors_in_embedding_df">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">closest_neighbors_in_embedding_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fetcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotting_func_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plot_proofread_neuron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotting_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#closest_neighbors_in_embedding_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.closest_neighbors_in_embedding_df" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To find the n_neighbors
closest to a certain embedding</p>
<p>Pseudocode:</p>
<ol class="arabic simple">
<li><p>Extract the matrix</p></li>
</ol>
<p>Ex:
from meshAfterParty.dataInterfaceMinnie65 import data_interface as hdju_m65
closest_neighbors_in_embedding_df(</p>
<blockquote>
<div><p>df = data_source_df,
data_name = “864691134884769786_0”,
n_neighbors = 5,
verbose = True,
data_fetcher = hdju_m65,
plot = True
)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.drop_limbs">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">drop_limbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limb_map_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pool1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#drop_limbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.drop_limbs" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To drop limbs randomly from a dataset</p>
<p>Pseudocode:
1) Get a mask for the limbs
2) Turn the mask of the limbs into a mask for the nodes
3) Use drop_nodes function</p>
<p>Ex:
new_d = gdu.drop_limbs(</p>
<blockquote>
<div><p>data = gdu.example_data_obj(),
verbose = True,
p = 0.3</p>
</div></blockquote>
<p>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.drop_nodes">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">drop_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attributes_to_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#drop_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.drop_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: to delete certain nodes from a dataset
based on a mask</p>
<p>Pseudocode:
1) Generate the mask if not defined
2) Get the node_idx of the mask
3) Generate vector of the new node ids</p>
<p>4) Find the new edges by dropping the edges with the nodes
and then finding the new edge</p>
<p>Ex:
from torch_geometric.data import Data
import numpy as np
from pytorch_tools import geometric_dataset_utils as gdu</p>
<p>d = gdu.example_data_obj()
new_d = gdu.drop_nodes(</p>
<blockquote>
<div><p>d,
p=0.5,
verbose = True,
#node_attributes_to_adjust=pool_attributes_affected_by_nodes</p>
</div></blockquote>
<p>)</p>
<p>Ex: With a prescribed mask</p>
<p>d = gdu.example_data_obj()
new_d = gdu.drop_nodes(</p>
<blockquote>
<div><p>d,
mask = torch.tensor([0,0,1,0,0,0],dtype=torch.bool),
p=0.5,
verbose = True,
#node_attributes_to_adjust=pool_attributes_affected_by_nodes</p>
</div></blockquote>
<p>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.example_data_obj">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">example_data_obj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#example_data_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.example_data_obj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.int_label_map">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">int_label_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#int_label_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.int_label_map" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.load_data">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extraction_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gnn_task_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnn_task'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_standardization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_int_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_adj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processed_data_folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_prior_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_append_to_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_process_labeled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_label_int_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: Will load the data for processing using the GNN models</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.load_data_hierarchical">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">load_data_hierarchical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processed_data_folder_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gnn_task_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnn_task'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_label_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_adj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_prior_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_process_labeled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes_to_include</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_label_int_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#load_data_hierarchical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.load_data_hierarchical" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: Will load the data for processing using the GNN models</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.normalization_df">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">normalization_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extraction_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#normalization_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.normalization_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.normalization_df_hierarchical">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">normalization_df_hierarchical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#normalization_df_hierarchical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.normalization_df_hierarchical" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To create the normalization dataframe
for all of the pooling layers</p>
<p>Pseudocode:
1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.normalize_and_filter_x_columns">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">normalize_and_filter_x_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#normalize_and_filter_x_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.normalize_and_filter_x_columns" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To normalize and filter the
x features</p>
<p>Pseudocode:
1) Get the columns want to normalize
2) For each row in the df:</p>
<blockquote>
<div><p>For each column to normalize:
a. Get the dataframe with x and turn into dataframe
b. Filter for columns you want
c. Normalize the columns using the normalization dataframe
d. Add the new data to a dataframe</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.pool_array_names">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">pool_array_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#pool_array_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.pool_array_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.pool_idx_stacked">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">pool_idx_stacked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pool1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_n_limbs_for_neuron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_adjustment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#pool_idx_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.pool_idx_stacked" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To generate a vector that represents the
mapping of nodes to unique limbs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.pytorch_data_hierarchical_from_single_data">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">pytorch_data_hierarchical_from_single_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_int_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_array_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes_to_include</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#pytorch_data_hierarchical_from_single_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.pytorch_data_hierarchical_from_single_data" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To convert a dictionary with
the data for one observation into a pytorch
geometric data object</p>
<p>Pseudocode:
1) Get all of the pool attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.set_ptr">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">set_ptr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#set_ptr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.set_ptr" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: to compute the new ptr
if a batch is readjusted</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.x_column_feature_name">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">x_column_feature_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#x_column_feature_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.x_column_feature_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_dataset_utils.x_columns">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">x_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_dataset_utils.html#x_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_dataset_utils.x_columns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.geometric_models">
<span id="pytorch-tools-geometric-models-module"></span><h2>pytorch_tools.geometric_models module<a class="headerlink" href="#module-pytorch_tools.geometric_models" title="Permalink to this heading"></a></h2>
<p>Notes:
Usually only have to use the batch variable when doing global pooling</p>
<p>Source: <a class="reference external" href="https://github.com/AntonioLonga/PytorchGeometricTutorial/blob/main/Tutorial16/Tutorial16.ipynb">https://github.com/AntonioLonga/PytorchGeometricTutorial/blob/main/Tutorial16/Tutorial16.ipynb</a></p>
<p>Note: This requires the data to be a dense matrix
1. so need to T.ToDense() transform
2. and the DenseDataLoader</p>
<p>– Still had bugs and couldn’t get to work</p>
<p>Official source: <a class="reference external" href="https://github.com/RexYing/diffpool">https://github.com/RexYing/diffpool</a></p>
<p>pyg implementation paper source = <a class="reference external" href="https://github.com/VoVAllen/diffpool">https://github.com/VoVAllen/diffpool</a></p>
<p>Tutorial: <a class="reference external" href="https://docs.dgl.ai/en/0.6.x/tutorials/models/2_small_graph/3_tree-lstm.html">https://docs.dgl.ai/en/0.6.x/tutorials/models/2_small_graph/3_tree-lstm.html</a></p>
<p>Code: <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/examples/pytorch/tree_lstm/tree_lstm.py">https://github.com/dmlc/dgl/blob/master/examples/pytorch/tree_lstm/tree_lstm.py</a></p>
<p>Improved Semantic Representations From Tree-Structured Long Short-Term Memory Networks
<a class="reference external" href="https://arxiv.org/abs/1503.00075">https://arxiv.org/abs/1503.00075</a></p>
<p>from . import geometric_models as gm
sys.path.append(“/pytorch_tools/pytorch_tools/HGP_SL”)
import models</p>
<p>model_name = “HGP_SL”
n_epochs = 500</p>
<dl class="simple">
<dt>architecture_kwargs = dict(</dt><dd><p>n_hidden_channels = 8,
#first_heads=8,
#output_heads=1,
#dropout=0.6,
#global_pool_type=”mean”</p>
</dd>
</dl>
<p>)</p>
<dl class="simple">
<dt>model = models.Model(</dt><dd><p>dataset_num_node_features=dataset.num_node_features,
dataset_num_classes=dataset.num_classes,
<a href="#id1"><span class="problematic" id="id2">**</span></a>architecture_kwargs
)</p>
</dd>
</dl>
<p>GraphSAGE did not import:</p>
<p>from torch_geometric.nn import SAGEConv
“””
Source: <a class="reference external" href="https://colab.research.google.com/github/sachinsharma9780/interactive_tutorials/blob/master/notebooks/example_output/Comprehensive_GraphSage_Guide_with_PyTorchGeometric_Output.ipynb#scrollTo=ROXBserO_amj">https://colab.research.google.com/github/sachinsharma9780/interactive_tutorials/blob/master/notebooks/example_output/Comprehensive_GraphSage_Guide_with_PyTorchGeometric_Output.ipynb#scrollTo=ROXBserO_amj</a></p>
<p>How GraphSAGE is different:</p>
<p>The GraphSage is different from GCNs is two ways: i.e.
1) Instead of taking the entire K-hop neighborhood of a</p>
<blockquote>
<div><p>target node, GraphSage first samples or prune the K-hop
neighborhood computation graph and then perform the
feature aggregation operation on this sampled graph
in order to generate the embeddings for a target node.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>During the learning process, in order to generate the node</dt><dd><p>embeddings; GraphSage learns the aggregator function
whereas GCNs make use of the symmetrically normalized
graph Laplacian.</p>
</dd>
</dl>
</li>
</ol>
<p>“””
class SAGE(torch.nn.Module):</p>
<blockquote>
<div><dl>
<dt>def __init__(</dt><dd><p>self,
dataset_num_node_features,
n_hidden_channels,
dataset_num_classes,
n_layers=3):
super(SAGE, self).__init__()</p>
<p>self.num_layers = n_layers</p>
<p>self.convs = torch.nn.ModuleList()
self.convs.append(SAGEConv(dataset_num_node_features, n_hidden_channels))
for _ in range(n_layers - 2):</p>
<blockquote>
<div><p>self.convs.append(SAGEConv(n_hidden_channels, n_hidden_channels))</p>
</div></blockquote>
<p>self.convs.append(SAGEConv(n_hidden_channels, dataset_num_classes))</p>
</dd>
<dt>def reset_parameters(self):</dt><dd><dl class="simple">
<dt>for conv in self.convs:</dt><dd><p>conv.reset_parameters()</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">BatchedDiffPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nfeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nnext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedDiffPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nfeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nnext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedDiffPool.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool.cluster">
<span class="sig-name descname"><span class="pre">cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedDiffPool.cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool.cluster" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedDiffPool.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedDiffPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedDiffPool.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedDiffPool.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedGraphSAGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">BatchedGraphSAGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedGraphSAGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedGraphSAGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedGraphSAGE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedGraphSAGE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedGraphSAGE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedGraphSAGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#BatchedGraphSAGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedGraphSAGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.BatchedGraphSAGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.BatchedGraphSAGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">ChildSumTreeLSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ChildSumTreeLSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ChildSumTreeLSTMCell.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell.apply_node_func">
<span class="sig-name descname"><span class="pre">apply_node_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ChildSumTreeLSTMCell.apply_node_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell.apply_node_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell.message_func">
<span class="sig-name descname"><span class="pre">message_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ChildSumTreeLSTMCell.message_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell.message_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell.reduce_func">
<span class="sig-name descname"><span class="pre">reduce_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ChildSumTreeLSTMCell.reduce_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell.reduce_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ChildSumTreeLSTMCell.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.ChildSumTreeLSTMCell.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.Classifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">Classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#Classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.Classifier" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.Classifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#Classifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.Classifier.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.Classifier.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#Classifier.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.Classifier.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.Classifier.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.Classifier.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">ClassifierBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tanh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tanh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierBase.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierBase.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierBase.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierBase.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierBase.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierBase.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierBase.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierFlat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">ClassifierFlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierFlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierFlat" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierFlat.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierFlat.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierFlat.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierFlat.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#ClassifierFlat.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierFlat.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.ClassifierFlat.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.ClassifierFlat.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">DiffPoolGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolGCN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN.dense_adj">
<span class="sig-name descname"><span class="pre">dense_adj</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN.dense_adj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolGCN.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolGCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolGCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolGCN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">DiffPoolSAGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSAGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSAGE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSAGE.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSAGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSAGE.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE.loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSAGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSAGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSimpleGNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">DiffPoolSimpleGNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSimpleGNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSimpleGNN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSimpleGNN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSimpleGNN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSimpleGNN.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSimpleGNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#DiffPoolSimpleGNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSimpleGNN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.DiffPoolSimpleGNN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.DiffPoolSimpleGNN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Source: <a class="reference external" href="https://github.com/marblet/GNN_models_pytorch_geometric/blob/master/models/gat.py">https://github.com/marblet/GNN_models_pytorch_geometric/blob/master/models/gat.py</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT.reset_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GAT.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GAT_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Source: <a class="reference external" href="https://github.com/marblet/GNN_models_pytorch_geometric/blob/master/models/gat.py">https://github.com/marblet/GNN_models_pytorch_geometric/blob/master/models/gat.py</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT_old.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT_old.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT_old.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GAT_old.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old.reset_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GAT_old.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GAT_old.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCN.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCN.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCN.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCN.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GCN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNFlat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GCNFlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">improved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNFlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNFlat" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNFlat.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">improved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNFlat.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNFlat.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNFlat.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNFlat.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNFlat.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNFlat.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNFlat.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNFlat.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNFlat.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GCNFlat.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GCNHierarchical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concatenate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_max_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchical" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Purpose: To run a GCN model but with
multiple steps of pooling</p>
<p>Ex: Testing the basic model
curr_model = GCNHierarchical(</p>
<blockquote>
<div><p>dataset_num_node_features=len(features_to_output_pool0),
dataset_num_classes=len(cell_type_map),
n_hidden_channels = 32,
n_hidden_channels_pool0 = [23,10,8],
n_hidden_channels_pool1 = [30,17,4],</p>
<p>num_node_features_pool1 = 1,
num_node_features_pool2 = 2,</p>
</div></blockquote>
<p>)</p>
<dl class="simple">
<dt>for jj,data in enumerate(test_loader):</dt><dd><p>out = curr_model(data)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchical.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concatenate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_max_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchical.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchical.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchical.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_pool_before_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchical.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchical.encode" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To encode the data to a certain pool range</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchical.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchical.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchical.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchical.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchical.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchicalOld">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GCNHierarchicalOld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchicalOld"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchicalOld" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Purpose: To run a GCN model but with
multiple steps of pooling</p>
<p>Ex: Testing the basic model
curr_model = GCNHierarchical(</p>
<blockquote>
<div><p>dataset_num_node_features=len(features_to_output_pool0),
dataset_num_classes=len(cell_type_map),
n_hidden_channels = 32,
n_hidden_channels_pool0 = [23,10,8],
n_hidden_channels_pool1 = [30,17,4],</p>
<p>num_node_features_pool1 = 1,
num_node_features_pool2 = 2,</p>
</div></blockquote>
<p>)</p>
<dl class="simple">
<dt>for jj,data in enumerate(test_loader):</dt><dd><p>out = curr_model(data)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchicalOld.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchicalOld.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchicalOld.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchicalOld.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchicalOld.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchicalOld.encode" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To encode the data to a certain pool range</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchicalOld.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GCNHierarchicalOld.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchicalOld.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GCNHierarchicalOld.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GCNHierarchicalOld.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">GraphSAGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GraphSAGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_n_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GraphSAGE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE.dense_adj">
<span class="sig-name descname"><span class="pre">dense_adj</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE.dense_adj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GraphSAGE.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#GraphSAGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.GraphSAGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.GraphSAGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.SAGEConvNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">SAGEConvNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Base'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tanh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#SAGEConvNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.SAGEConvNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.SAGEConvNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Base'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tanh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#SAGEConvNet.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.SAGEConvNet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.SAGEConvNet.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#SAGEConvNet.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.SAGEConvNet.encode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.SAGEConvNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#SAGEConvNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.SAGEConvNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.SAGEConvNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.SAGEConvNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">TreeLSTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM.directed">
<span class="sig-name descname"><span class="pre">directed</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM.directed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTM.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM.encode" title="Permalink to this definition"></a></dt>
<dd><p>Compute tree-lstm prediction given a batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>dgl.data.SSTBatch</em>) – The data batch.</p></li>
<li><p><strong>h</strong> (<em>Tensor</em>) – Initial hidden state.</p></li>
<li><p><strong>c</strong> (<em>Tensor</em>) – Initial cell state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logits</strong> – The prediction of each node.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTM.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTM.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTM.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models.</span></span><span class="sig-name descname"><span class="pre">TreeLSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTMCell.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell.apply_node_func">
<span class="sig-name descname"><span class="pre">apply_node_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTMCell.apply_node_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell.apply_node_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell.message_func">
<span class="sig-name descname"><span class="pre">message_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTMCell.message_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell.message_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell.reduce_func">
<span class="sig-name descname"><span class="pre">reduce_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models.html#TreeLSTMCell.reduce_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell.reduce_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models.TreeLSTMCell.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.geometric_models.TreeLSTMCell.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_tools.geometric_models_overload">
<span id="pytorch-tools-geometric-models-overload-module"></span><h2>pytorch_tools.geometric_models_overload module<a class="headerlink" href="#module-pytorch_tools.geometric_models_overload" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models_overload.GCNConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_models_overload.</span></span><span class="sig-name descname"><span class="pre">GCNConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">improved</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models_overload.html#GCNConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models_overload.GCNConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GCNConv</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models_overload.GCNConv.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">improved</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_models_overload.html#GCNConv.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models_overload.GCNConv.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.geometric_models_overload.GCNConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">SparseTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pytorch_tools/geometric_models_overload.html#GCNConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_models_overload.GCNConv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_tools.geometric_tensor_utils">
<span id="pytorch-tools-geometric-tensor-utils-module"></span><h2>pytorch_tools.geometric_tensor_utils module<a class="headerlink" href="#module-pytorch_tools.geometric_tensor_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.global_mean_pool">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">global_mean_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#global_mean_pool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.global_mean_pool" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.global_mean_weighted_pool">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">global_mean_weighted_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#global_mean_weighted_pool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.global_mean_weighted_pool" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To do a weighted mean pooling for
a batch</p>
<p>Ex:
from pytorch_tools import tensor_utils as tenu
x = torch.Tensor([70,80,90,100,110,120])
w = torch.Tensor([10,5,15,10,5,15])
batch = torch.tensor(np.array([0,0,0,1,1,1]),dtype=torch.int64)
tenu.global_mean_weighted_pool(x,batch,w)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.n_in_pool_from_pool_tensor">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">n_in_pool_from_pool_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#n_in_pool_from_pool_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.n_in_pool_from_pool_tensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.normalize_in_pool_from_pool_tensor">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">normalize_in_pool_from_pool_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#normalize_in_pool_from_pool_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.normalize_in_pool_from_pool_tensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.pool_idx_from_pool_tensor">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">pool_idx_from_pool_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#pool_idx_from_pool_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.pool_idx_from_pool_tensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_tensor_utils.ptr_from_pool_tensor">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_tensor_utils.</span></span><span class="sig-name descname"><span class="pre">ptr_from_pool_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_tensor_utils.html#ptr_from_pool_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_tensor_utils.ptr_from_pool_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: to compute a new ptr tensor from
a pool tensor</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.geometric_utils">
<span id="pytorch-tools-geometric-utils-module"></span><h2>pytorch_tools.geometric_utils module<a class="headerlink" href="#module-pytorch_tools.geometric_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.geometric_utils.from_networkx">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.geometric_utils.</span></span><span class="sig-name descname"><span class="pre">from_networkx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_node_attrs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">all</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_edge_attrs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">all</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/geometric_utils.html#from_networkx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.geometric_utils.from_networkx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.hierarchical_utils">
<span id="pytorch-tools-hierarchical-utils-module"></span><h2>pytorch_tools.hierarchical_utils module<a class="headerlink" href="#module-pytorch_tools.hierarchical_utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytorch_tools.hierarchical_utils.</span></span><span class="sig-name descname"><span class="pre">GCNHierarchicalClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_node_features_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concatenate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lin_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">super_node_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pool_after_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pool_after_pool1_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_clf_n_layers_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_clf_n_layers_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_max_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#GCNHierarchicalClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Purpose: To run a GCN network that
has a middle step that hierarchically pools
nodes together and runs a classification on them
and returns both the overall classification and the node classification</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_num_node_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_channels_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_node_features_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_layer_outputs_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concatenate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lin_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">super_node_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pool_after_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pool_after_pool1_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_clf_n_layers_pool0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_clf_n_layers_pool1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_max_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#GCNHierarchicalClassifier.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_encode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#GCNHierarchicalClassifier.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.encode" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To pass dta through all of the gcn layers
and classifier layers and return the following:</p>
<p>Pseudocode:
1) pool0 GCN layer
2) Pool the nodes together into limbs
2) Feed into classifier (save the outputs and y)
3) concatenate x_pool1 to features
4) pool1 GCN layer
5) Pool the nodes together
6) Pass through classifier</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#GCNHierarchicalClassifier.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_tools.hierarchical_utils.GCNHierarchicalClassifier.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.forward_pass">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.hierarchical_utils.</span></span><span class="sig-name descname"><span class="pre">forward_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool1_weight_by_pool2_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool1_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool2_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches_per_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nll_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_predicted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_return_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_return_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict_for_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#forward_pass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.forward_pass" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: Want to generate y_pred/y_true or dataframes for</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.hierarchical_utils.hierarchical_loss">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.hierarchical_utils.</span></span><span class="sig-name descname"><span class="pre">hierarchical_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool1_weight_by_pool2_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool1_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_pool2_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_separate_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/hierarchical_utils.html#hierarchical_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.hierarchical_utils.hierarchical_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.loss_utils">
<span id="pytorch-tools-loss-utils-module"></span><h2>pytorch_tools.loss_utils module<a class="headerlink" href="#module-pytorch_tools.loss_utils" title="Permalink to this heading"></a></h2>
<p>Cross Entropy Loss (Log Likelihood):</p>
<p>Overall Idea:
1) Given the estimated probabilities
2) Takes the log (so hihger probabilites get less of an absolute number)</p>
<blockquote>
<div><p>They are all negative numbers</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Picks the probability of the right class</p></li>
<li><p>Flips the sign so becomes positive (so the less prediction probability the more loss)</p></li>
<li><p>Applies the weight to magnify the loss felt for the class it should have been</p></li>
</ol>
<p>Effect of weight: When the clasifier is wrong on a highly weighted class
- IT REALLY POORS ON THE LOSS MAGNITUDE (unless perfect)</p>
<p>Makes everything a probability and then just sums up
the probabilities of the things that should be right</p>
<p>What it does in regular terms:
1) Has model compute the probabilities of each class
2) Takes a log of all the probabilities (log probabilies)
3) Taks the log probability of the class it should be
- so the higher the probability the lower the absolute value of the number
4) Adds up them all in batch
– at this point the lower the absolute then the better performance
5) Takes the negative so the higher actual number the worse, and the
lower the actual number the better (so can just minimize)</p>
<p>NLLLoss: just sums the negative weighted number
- requires softmax and log to already be computed</p>
<p>CrossEntropy:
1) applies softmax
2) applies log
3) multiples by weight and turns negative</p>
<p>All 3 of these models would produce the same output</p>
<p>— Example 1: Outputs probabilities and then uss log with NLL Loss —-</p>
<blockquote>
<div><p>from torch.nn import Linear
import torch.nn.functional as F
from torch_geometric.nn import GCNConv
from torch_geometric.nn import global_mean_pool</p>
<dl class="simple">
<dt>class GCN(torch.nn.Module):</dt><dd><dl class="simple">
<dt>def __init__(self, hidden_channels):</dt><dd><p>super(GCN, self).__init__()
torch.manual_seed(12345)
self.conv1 = GCNConv(dataset.num_node_features, hidden_channels,bias=True)
self.conv2 = GCNConv(hidden_channels,  hidden_channels,bias=True)
self.conv3 = GCNConv(hidden_channels,  dataset.num_classes,bias=True)</p>
</dd>
<dt>def forward(self, data):</dt><dd><p># 1. Obtain node embeddings
x, edge_index = data.x, data.edge_index
batch = data.batch
x = self.conv1(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv2(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv3(x, edge_index)</p>
</dd>
</dl>
</dd>
</dl>
<p>#         x = self.conv3(x, edge_index)</p>
<blockquote>
<div><p># 2. Readout layer
#x = global_mean_pool(x, batch)  # [batch_size, hidden_channels]</p>
<p># 3. Apply a final classifier
# x = F.dropout(x, p=0.5, training=self.training)
#x = self.lin(x)
return F.softmax(x, dim=1)</p>
</div></blockquote>
<p>model = GCN(hidden_channels=7).to(device)
out = model(curr_data)
print(out)
# criterion = F.nll_loss(
#     weight=class_weights,
# )
F.nll_loss(torch.log(out),curr_data.y)</p>
</div></blockquote>
<p>—— Example 2: LogSoftmax Output and then usses NLL</p>
<blockquote>
<div><dl class="simple">
<dt>class GCN(torch.nn.Module):</dt><dd><dl class="simple">
<dt>def __init__(self, hidden_channels):</dt><dd><p>super(GCN, self).__init__()
torch.manual_seed(12345)
self.conv1 = GCNConv(dataset.num_node_features, hidden_channels,bias=True)
self.conv2 = GCNConv(hidden_channels,  hidden_channels,bias=True)
self.conv3 = GCNConv(hidden_channels,  dataset.num_classes,bias=True)</p>
</dd>
<dt>def forward(self, data):</dt><dd><p># 1. Obtain node embeddings
x, edge_index = data.x, data.edge_index
batch = data.batch
x = self.conv1(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv2(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv3(x, edge_index)</p>
</dd>
</dl>
</dd>
</dl>
<p>#         x = self.conv3(x, edge_index)</p>
<blockquote>
<div><p># 2. Readout layer
#x = global_mean_pool(x, batch)  # [batch_size, hidden_channels]</p>
<p># 3. Apply a final classifier
# x = F.dropout(x, p=0.5, training=self.training)
#x = self.lin(x)
return F.log_softmax(x, dim=1)</p>
</div></blockquote>
<p>model = GCN(hidden_channels=7).to(device)
out = model(curr_data)
print(out)
# criterion = F.nll_loss(
#     weight=class_weights,
# )
F.nll_loss(out,curr_data.y)</p>
</div></blockquote>
<p># —- Example 3: Raw Output and then uses Cross Entropy—-</p>
<blockquote>
<div><dl class="simple">
<dt>class GCN(torch.nn.Module):</dt><dd><dl class="simple">
<dt>def __init__(self, hidden_channels):</dt><dd><p>super(GCN, self).__init__()
torch.manual_seed(12345)
self.conv1 = GCNConv(dataset.num_node_features, hidden_channels,bias=True)
self.conv2 = GCNConv(hidden_channels,  hidden_channels,bias=True)
self.conv3 = GCNConv(hidden_channels,  dataset.num_classes,bias=True)</p>
</dd>
<dt>def forward(self, data):</dt><dd><p># 1. Obtain node embeddings
x, edge_index = data.x, data.edge_index
batch = data.batch
x = self.conv1(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv2(x, edge_index)
x = F.relu(x)
x = F.dropout(x, training=self.training)
x = self.conv3(x, edge_index)</p>
</dd>
</dl>
</dd>
</dl>
<p>#         x = self.conv3(x, edge_index)</p>
<blockquote>
<div><p># 2. Readout layer
#x = global_mean_pool(x, batch)  # [batch_size, hidden_channels]</p>
<p># 3. Apply a final classifier
# x = F.dropout(x, p=0.5, training=self.training)
#x = self.lin(x)
return x</p>
</div></blockquote>
<p>model = GCN(hidden_channels=7).to(device)
out = model(curr_data)
print(out)
# criterion = F.nll_loss(
#     weight=class_weights,
# )
criterion = torch.nn.CrossEntropyLoss()
criterion(out,curr_data.y)</p>
</div></blockquote>
</section>
<section id="module-pytorch_tools.model_utils">
<span id="pytorch-tools-model-utils-module"></span><h2>pytorch_tools.model_utils module<a class="headerlink" href="#module-pytorch_tools.model_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.model_utils.load_checkpoint_to_model">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.model_utils.</span></span><span class="sig-name descname"><span class="pre">load_checkpoint_to_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/model_utils.html#load_checkpoint_to_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.model_utils.load_checkpoint_to_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.model_utils.save_checkpoint">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.model_utils.</span></span><span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/model_utils.html#save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.model_utils.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.parameters_utils">
<span id="pytorch-tools-parameters-utils-module"></span><h2>pytorch_tools.parameters_utils module<a class="headerlink" href="#module-pytorch_tools.parameters_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.add_noise_to_parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">add_noise_to_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#add_noise_to_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.add_noise_to_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.check_gradient_on_parameters_finite">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">check_gradient_on_parameters_finite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#check_gradient_on_parameters_finite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.check_gradient_on_parameters_finite" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.copy_model_parameters_to_model">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">copy_model_parameters_to_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#copy_model_parameters_to_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.copy_model_parameters_to_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.isnan_in_parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">isnan_in_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#isnan_in_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.isnan_in_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.layer_bias">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">layer_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#layer_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.layer_bias" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.layer_parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">layer_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#layer_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.layer_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.load_state_dict">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#load_state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.load_state_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_extrema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.parameters" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To print the out the parameters and their values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.print_parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">print_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_extrema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#print_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.print_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.set_geometric_parameters">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">set_geometric_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#set_geometric_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.set_geometric_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.parameters_utils.state_dict">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.parameters_utils.</span></span><span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/parameters_utils.html#state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.parameters_utils.state_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.preprocessing_utils">
<span id="pytorch-tools-preprocessing-utils-module"></span><h2>pytorch_tools.preprocessing_utils module<a class="headerlink" href="#module-pytorch_tools.preprocessing_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.preprocessing_utils.train_val_test_split">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.preprocessing_utils.</span></span><span class="sig-name descname"><span class="pre">train_val_test_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/preprocessing_utils.html#train_val_test_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.preprocessing_utils.train_val_test_split" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.tensor_utils">
<span id="pytorch-tools-tensor-utils-module"></span><h2>pytorch_tools.tensor_utils module<a class="headerlink" href="#module-pytorch_tools.tensor_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.add_noise">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#add_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.add_noise" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.cat">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.cat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.cumsum">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#cumsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.cumsum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.generator_from_seed">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">generator_from_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#generator_from_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.generator_from_seed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.intersect1d">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">intersect1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#intersect1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.intersect1d" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To find the intersection between 2 tensors</p>
<p>Ex:
a = torch.tensor([1,2,3,4,],dtype=torch.int)
b = torch.tensor([4,5,],dtype=torch.int)</p>
<p>tenu.intersect1d(a,b,return_mask=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.isnan">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">isnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#isnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.isnan" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.isnan_any">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">isnan_any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#isnan_any"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.isnan_any" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.map_tensor_with_tensor">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">map_tensor_with_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#map_tensor_with_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.map_tensor_with_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: Map numbers of one tensor
to another number where the mapping is defined in the second tensort where</p>
<p>index –&gt; array_map[index]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.numpy_array">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#numpy_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.numpy_array" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.random_gaussian">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">random_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#random_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.random_gaussian" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.random_mask">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">random_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#random_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.random_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.random_sample_between_interval">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">random_sample_between_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#random_sample_between_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.random_sample_between_interval" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensor_utils.vstack">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">vstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensor_utils.html#vstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensor_utils.vstack" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To vertically stack tensors on top
of each other</p>
<p>Ex:
x = torch.Tensor([[1,2,3,4,5],[7,8,9,10,11]])
new_values = torch.Tensor([10,20,30,40,50])
torch.vstack([x,new_values])</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.tensorboard_utils">
<span id="pytorch-tools-tensorboard-utils-module"></span><h2>pytorch_tools.tensorboard_utils module<a class="headerlink" href="#module-pytorch_tools.tensorboard_utils" title="Permalink to this heading"></a></h2>
<p># how to run tensorboard inside a docker container
%load_ext tensorboard
%tensorboard –logdir /neuron_mesh_tools/Auto_Proofreading/Minnie65_Analysis/GNN_Classification/GNN_Models/runs –bind_all</p>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.tensorboard_utils.df_tensorboard">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.tensorboard_utils.</span></span><span class="sig-name descname"><span class="pre">df_tensorboard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepaths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/tensorboard_utils.html#df_tensorboard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.tensorboard_utils.df_tensorboard" title="Permalink to this definition"></a></dt>
<dd><p>Convert local TensorBoard data into Pandas DataFrame.</p>
<p>Function takes the root directory path and recursively parses
all events data.
If the <cite>sort_by</cite> value is provided then it will use that column
to sort values; typically <cite>wall_time</cite> or <cite>step</cite>.</p>
<p><em>Note</em> that the whole data is converted into a DataFrame.
Depending on the data size this might take a while. If it takes
too long then narrow it to some sub-directories.</p>
<dl class="simple">
<dt>Paramters:</dt><dd><p>root_dir: (str) path to root dir with tensorboard data.
sort_by: (optional str) column name to sort by.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame with [wall_time, name, step, value] columns.</p>
</dd>
</dl>
<p>source: <a class="reference external" href="https://laszukdawid.com/blog/2021/01/26/parsing-tensorboard-data-locally/">https://laszukdawid.com/blog/2021/01/26/parsing-tensorboard-data-locally/</a></p>
</dd></dl>

</section>
<section id="module-pytorch_tools.torch_display_utils">
<span id="pytorch-tools-torch-display-utils-module"></span><h2>pytorch_tools.torch_display_utils module<a class="headerlink" href="#module-pytorch_tools.torch_display_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.torch_display_utils.set_printoptions">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.torch_display_utils.</span></span><span class="sig-name descname"><span class="pre">set_printoptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgeitems</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/torch_display_utils.html#set_printoptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.torch_display_utils.set_printoptions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytorch_tools.train_test_geometric_utils">
<span id="pytorch-tools-train-test-geometric-utils-module"></span><h2>pytorch_tools.train_test_geometric_utils module<a class="headerlink" href="#module-pytorch_tools.train_test_geometric_utils" title="Permalink to this heading"></a></h2>
<p>Purpose: To store functions that help with training and testing</p>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.train_test_geometric_utils.forward_pass">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.train_test_geometric_utils.</span></span><span class="sig-name descname"><span class="pre">forward_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_batches_per_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nll_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_predicted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict_for_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/train_test_geometric_utils.html#forward_pass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.train_test_geometric_utils.forward_pass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_tools.train_test_geometric_utils.forward_pass_embed_df">
<span class="sig-prename descclassname"><span class="pre">pytorch_tools.train_test_geometric_utils.</span></span><span class="sig-name descname"><span class="pre">forward_pass_embed_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_predicted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytorch_tools/train_test_geometric_utils.html#forward_pass_embed_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_tools.train_test_geometric_utils.forward_pass_embed_df" title="Permalink to this definition"></a></dt>
<dd><p>Purpose: To return a dataframe with the embeddings
and the names and soruce if specified</p>
</dd></dl>

</section>
<section id="module-pytorch_tools.training_layer_utils">
<span id="pytorch-tools-training-layer-utils-module"></span><h2>pytorch_tools.training_layer_utils module<a class="headerlink" href="#module-pytorch_tools.training_layer_utils" title="Permalink to this heading"></a></h2>
<p>How to use Batchnorm —- done before the activation —–</p>
<dl>
<dt>class Net(nn.Module):</dt><dd><dl>
<dt>def __init__(self):</dt><dd><p>super(Net,self).__init__()
self.conv1=nn.Conv2d(1,32,3,1)
self.conv1_bn=nn.BatchNorm2d(32)</p>
<p>self.conv2=nn.Conv2d(32,64,3,1)
self.conv2_bn=nn.BatchNorm2d(64)</p>
<p>self.dropout1=nn.Dropout(0.25)</p>
<p>self.fc1=nn.Linear(9216,128)
self.fc1_bn=nn.BatchNorm1d(128)</p>
<p>self.fc2=nn.Linear(128,10)</p>
</dd>
<dt>def forward(self,x):</dt><dd><p>x=self.conv1(x)
x=F.relu(self.conv1_bn(x))</p>
<p>x=self.conv2(x)
x=F.relu(self.conv2_bn(x))</p>
<p>x=F.max_pool2d(x,2)
x=self.dropout1(x)</p>
<p>x=torch.flatten(x,1)</p>
<p>x=self.fc1(x)
x=F.relu(self.fc1_bn(x))</p>
<p>x=self.fc2(x)
output=F.log_softmax(x,dim=1)
return output</p>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="module-pytorch_tools.xai_geometric_utils">
<span id="pytorch-tools-xai-geometric-utils-module"></span><h2>pytorch_tools.xai_geometric_utils module<a class="headerlink" href="#module-pytorch_tools.xai_geometric_utils" title="Permalink to this heading"></a></h2>
<p>Local
1) Example of how to do node prediction GNN XAI with GNNExplainer:
<a class="reference external" href="https://www.youtube.com/watch?v=aFnlmzFh4iQ">https://www.youtube.com/watch?v=aFnlmzFh4iQ</a></p>
<blockquote>
<div><p>code: <a class="reference external" href="https://colab.research.google.com/drive/1s-mHf1_pKqohXj1pny-x-dqisCzMFB6A?usp=sharing#scrollTo=vyYKjY2JiQrX">https://colab.research.google.com/drive/1s-mHf1_pKqohXj1pny-x-dqisCzMFB6A?usp=sharing#scrollTo=vyYKjY2JiQrX</a></p>
</div></blockquote>
<p>For conterfactual explanations:
1) Robust Counterfactual Explanation: <a class="reference external" href="https://openreview.net/forum?id=Uq_tGs7N54M">https://openreview.net/forum?id=Uq_tGs7N54M</a>
Code: <a class="reference external" href="https://developer.huaweicloud.com/develop/aigallery/notebook/detail?id=e41f63d3-e346-4891-bf6a-40e64b4a3278">https://developer.huaweicloud.com/develop/aigallery/notebook/detail?id=e41f63d3-e346-4891-bf6a-40e64b4a3278</a></p>
</section>
<section id="module-pytorch_tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pytorch_tools" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="pytorch_tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Brendan Celii.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>